<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>libsdbx-1.0: LRUCache&lt; CachedObjectType, IdType, deleteObject &gt; Class Template Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.7 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>LRUCache&lt; CachedObjectType, IdType, deleteObject &gt; Class Template Reference</h1><!-- doxytag: class="LRUCache" -->Implements a relatively simple and low-overhead LRU-style caching mechanism.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;<a class="el" href="a00059.html">lru.h</a>&gt;</code>
<p>
<div class="dynheader">
Collaboration diagram for LRUCache&lt; CachedObjectType, IdType, deleteObject &gt;:</div>
<div class="dynsection">
<p><center><img src="a00087.png" border="0" usemap="#a00088" alt="Collaboration graph"></center>
<map name="a00088">
<area shape="rect" href="a00006.html" title="Struct that stores the information for the LRU cache nodes." alt="" coords="5,5,293,101"></map>
<center><font size="2">[<a target="top" href="graph_legend.html">legend</a>]</font></center></div>

<p>
<a href="a00089.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Types</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="6411bcd6a31b6fdec535693994a6328c"></a><!-- doxytag: member="LRUCache::Node" ref="6411bcd6a31b6fdec535693994a6328c" args="" -->
typedef <a class="el" href="a00006.html">LRUCacheNode</a><br class="typebreak">
&lt; CachedObjectType, IdType, <br class="typebreak">
deleteObject &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><b>Node</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="79f9a43f0345076e86050c6cebdfa0e7"></a><!-- doxytag: member="LRUCache::NodeArray" ref="79f9a43f0345076e86050c6cebdfa0e7" args="" -->
typedef std::vector&lt; <a class="el" href="a00006.html">Node</a> * &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><b>NodeArray</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="3cc85ab629d0ea0414adaf8f148dba05"></a><!-- doxytag: member="LRUCache::NodeIterator" ref="3cc85ab629d0ea0414adaf8f148dba05" args="" -->
typedef NodeArray::iterator&nbsp;</td><td class="memItemRight" valign="bottom"><b>NodeIterator</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="04b7e1f3f7dd1c1beacc51c0af541f8e"></a><!-- doxytag: member="LRUCache::NodeSorter" ref="04b7e1f3f7dd1c1beacc51c0af541f8e" args="" -->
typedef <a class="el" href="a00010.html">LRUCacheNodeSorter</a>&lt; <a class="el" href="a00006.html">Node</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><b>NodeSorter</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="e6a856c278487a3d36f84d528a1b2908"></a><!-- doxytag: member="LRUCache::size_type" ref="e6a856c278487a3d36f84d528a1b2908" args="" -->
typedef std::size_t&nbsp;</td><td class="memItemRight" valign="bottom"><b>size_type</b></td></tr>

<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="a00006.html">Node</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00005.html#d9c503c0b8f77c161f80205495bb4b2e">add</a> (const IdType &amp;id, CachedObjectType *object) WARN_IF_UNUSED</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Adds an item to the list.  <a href="#d9c503c0b8f77c161f80205495bb4b2e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="86654d056acc1762c34f0a8ef47f1e35"></a><!-- doxytag: member="LRUCache::get" ref="86654d056acc1762c34f0a8ef47f1e35" args="(const IdType &amp;id)" -->
CachedObjectType *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00005.html#86654d056acc1762c34f0a8ef47f1e35">get</a> (const IdType &amp;id)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gets the item, or returns NULL. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="6477b5cfa837db678c128743fa29581c"></a><!-- doxytag: member="LRUCache::LRUCache" ref="6477b5cfa837db678c128743fa29581c" args="(const size_type &amp;max_nodes)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>LRUCache</b> (const size_type &amp;max_nodes)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="a00006.html">Node</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00005.html#b34c7737ff4ca63d5bdcef9f35edf08b">removeOne</a> () WARN_IF_UNUSED</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Removes an arbitrary CacheNode.  <a href="#b34c7737ff4ca63d5bdcef9f35edf08b"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
<h3>template&lt;typename CachedObjectType, typename IdType, LRUCacheDeleteType deleteObject&gt;<br>
 class LRUCache&lt; CachedObjectType, IdType, deleteObject &gt;</h3>

Implements a relatively simple and low-overhead LRU-style caching mechanism. 
<p>
A key thing here is to remember that when you pass this thing an object, it *owns* that object (if you set deleteObject to true). So once it falls over the edge of the LRU list, then it is no longer valid. So basically, anytime that you need to use an item stored in here, you must query for it.<p>
Is this a good idea? That sounds like its asking for trouble. However, I can't think of a good reason why you would keep references for more than one object anyways...<p>
Ok, I can think of a problem case: recursion. If you call something that uses this, which uses this... and one of them falls off the end of the list, then you're screwed.<p>
If LRUCACHE_DEBUG == true, then this will keep statistics about hits and misses.<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000004">Todo:</a></b></dt><dd>Add locks or something to that effect..</dd></dl>

<p>Definition at line <a class="el" href="a00059.html#l00182">182</a> of file <a class="el" href="a00059.html">lru.h</a>.</p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="d9c503c0b8f77c161f80205495bb4b2e"></a><!-- doxytag: member="LRUCache::add" ref="d9c503c0b8f77c161f80205495bb4b2e" args="(const IdType &amp;id, CachedObjectType *object) WARN_IF_UNUSED" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename CachedObjectType , typename IdType , LRUCacheDeleteType deleteObject&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00006.html">Node</a>* <a class="el" href="a00005.html">LRUCache</a>&lt; CachedObjectType, IdType, deleteObject &gt;::add           </td>
          <td>(</td>
          <td class="paramtype">const IdType &amp;&nbsp;</td>
          <td class="paramname"> <em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CachedObjectType *&nbsp;</td>
          <td class="paramname"> <em>object</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Adds an item to the list. 
<p>
Use <a class="el" href="a00005.html#86654d056acc1762c34f0a8ef47f1e35" title="Gets the item, or returns NULL.">get()</a> first to determine whether the object actually lives in the cache or not<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>a node object, you should delete it after this call returns. This contains the item and its id. </dd></dl>

<p>Definition at line <a class="el" href="a00059.html#l00275">275</a> of file <a class="el" href="a00059.html">lru.h</a>.</p>

<p>References <a class="el" href="a00059.html#l00078">LRUCacheNode&lt; CachedObjectType, IdType, deleteType &gt;::next</a>, and <a class="el" href="a00059.html#l00079">LRUCacheNode&lt; CachedObjectType, IdType, deleteType &gt;::prev</a>.</p>

<p>Referenced by <a class="el" href="a00070.html#l00280">StringTable&lt; _key_length, max_child_items &gt;::GetStringById()</a>, and <a class="el" href="a00070.html#l00366">StringTable&lt; _key_length, max_child_items &gt;::InsertString()</a>.</p>

</div>
</div><p>
<a class="anchor" name="b34c7737ff4ca63d5bdcef9f35edf08b"></a><!-- doxytag: member="LRUCache::removeOne" ref="b34c7737ff4ca63d5bdcef9f35edf08b" args="() WARN_IF_UNUSED" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename CachedObjectType , typename IdType , LRUCacheDeleteType deleteObject&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00006.html">Node</a>* <a class="el" href="a00005.html">LRUCache</a>&lt; CachedObjectType, IdType, deleteObject &gt;::removeOne           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Removes an arbitrary CacheNode. 
<p>
This is useful for clearing the cache: you remove items one by one and if the item needs to be written back to disk, you do so.<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>A node object, you should delete it after this call returns. This contains the item and its id. </dd></dl>

<p>Definition at line <a class="el" href="a00059.html#l00319">319</a> of file <a class="el" href="a00059.html">lru.h</a>.</p>

</div>
</div><p>
<hr>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="a00059.html">lru.h</a></ul>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Tue Aug 18 13:28:42 2009 for libsdbx-1.0 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.7 </small></address>
</body>
</html>
