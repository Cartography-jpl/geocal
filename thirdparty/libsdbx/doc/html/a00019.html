<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>libsdbx-1.0: SerializedFile&lt; T, start_offset &gt; Class Template Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.7 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>SerializedFile&lt; T, start_offset &gt; Class Template Reference</h1><!-- doxytag: class="SerializedFile" -->Loads/Saves arrays of fixed-size objects to/from a file.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;<a class="el" href="a00069.html">SerializedFile.h</a>&gt;</code>
<p>

<p>
<a href="a00117.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Types</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="b65d15a8fbb4002a579b920ff79407ad"></a><!-- doxytag: member="SerializedFile::IdType" ref="b65d15a8fbb4002a579b920ff79407ad" args="" -->
typedef size_type&nbsp;</td><td class="memItemRight" valign="bottom"><b>IdType</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00019.html#99054aed7a18dee9afd6ba6e8a3e347f">SerializedFileError</a> { <b>ERR_NONE</b> =  0, 
<a class="el" href="a00019.html#99054aed7a18dee9afd6ba6e8a3e347fece3cfbcbe16262f50266fa2b597b634">ERR_BAD_SEEK</a>, 
<a class="el" href="a00019.html#99054aed7a18dee9afd6ba6e8a3e347f128d9a14eed7bd9e3ef32d4888189550">ERR_BAD_WRITE</a>, 
<a class="el" href="a00019.html#99054aed7a18dee9afd6ba6e8a3e347f691a032468e8f0a09da4e989921deb58">ERR_BAD_READ</a>
 }</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="6772c0b609d718f936e60f3b71e31931"></a><!-- doxytag: member="SerializedFile::size_type" ref="6772c0b609d718f936e60f3b71e31931" args="" -->
typedef uint64_t&nbsp;</td><td class="memItemRight" valign="bottom"><b>size_type</b></td></tr>

<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="0102df05ef6e2fd4ad61aceff9a20248"></a><!-- doxytag: member="SerializedFile::Delete" ref="0102df05ef6e2fd4ad61aceff9a20248" args="()" -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00019.html#0102df05ef6e2fd4ad61aceff9a20248">Delete</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">deletes the file this is associated with <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="7f72d52abd9202cf7b01933c9b9078aa"></a><!-- doxytag: member="SerializedFile::GetErrorCode" ref="7f72d52abd9202cf7b01933c9b9078aa" args="() const " -->
<a class="el" href="a00019.html#99054aed7a18dee9afd6ba6e8a3e347f">SerializedFileError</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00019.html#7f72d52abd9202cf7b01933c9b9078aa">GetErrorCode</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the most recent error code. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="6df78547557b3c0460a49492f1ef5249"></a><!-- doxytag: member="SerializedFile::GetErrorString" ref="6df78547557b3c0460a49492f1ef5249" args="() const " -->
wxString&nbsp;</td><td class="memItemRight" valign="bottom"><b>GetErrorString</b> () const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="9a0884008210efce9a31601496b40ddd"></a><!-- doxytag: member="SerializedFile::GetFFile" ref="9a0884008210efce9a31601496b40ddd" args="()" -->
wxFFile *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00019.html#9a0884008210efce9a31601496b40ddd">GetFFile</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the file handle underneath this class. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">IdType&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00019.html#da9cb5dbe8308b74c31a4798c49d255f">GetLastId</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gets the last ID contained in the file.  <a href="#da9cb5dbe8308b74c31a4798c49d255f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="677d49ee2f8616db15f86822f2c04df8"></a><!-- doxytag: member="SerializedFile::IsOpened" ref="677d49ee2f8616db15f86822f2c04df8" args="() const " -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00019.html#677d49ee2f8616db15f86822f2c04df8">IsOpened</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Check to see if the file is initialized properly. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">size_type&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00019.html#3c6b781c2dfa9d9759786602b6e133fe">LoadObjects</a> (const IdType &amp;start_id, const size_t count, T *dst)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Load objects from the file into an array.  <a href="#3c6b781c2dfa9d9759786602b6e133fe"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">size_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00019.html#dc926bd60ea435b9a1a1adede3a79e7e">SaveObjects</a> (const IdType &amp;start_id, const size_t count, const T *const src)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Writes a specified number of objects from an array to file.  <a href="#dc926bd60ea435b9a1a1adede3a79e7e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00019.html#7a12f5b8c1959ec98516461816416d3d">SerializedFile</a> (const wxFileName &amp;filename, size_t buffer_size=4096)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Opens the file.  <a href="#7a12f5b8c1959ec98516461816416d3d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="405112a9647df4e890a6df51f5cca836"></a><!-- doxytag: member="SerializedFile::SetBufferSize" ref="405112a9647df4e890a6df51f5cca836" args="(const size_t buffer_size)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>SetBufferSize</b> (const size_t buffer_size)</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
<h3>template&lt;typename T, wxFileOffset start_offset = 0&gt;<br>
 class SerializedFile&lt; T, start_offset &gt;</h3>

Loads/Saves arrays of fixed-size objects to/from a file. 
<p>
<dl class="note" compact><dt><b>Note:</b></dt><dd>Notice that it says 'fixed-size' objects. This is not designed to do variable-length serialization.</dd></dl>
The object being stored in the external vector can be anything, but must have the following members:<p>
struct T { explicit T(const unsigned char * const buffer); void Serialize(unsigned char * buffer); enum { record_size }; };<p>
This allows optimized serialization of the items being stored, especially if the compiler inlines the operation. It is important to keep the relative ordering of the class variables in mind when you implement serialization constructors (otherwise GCC will complain, among other things). An example implementation looks like this:<p>
struct SerializedInt {<p>
int item1; int item2;<p>
/ serialization constructor explicit SerializedInt(const unsigned char * const buffer) : DESERIALIZE(int, 0, item1), DESERIALIZE(int, sizeof(int), item2) {}<p>
/ serializer function void Serialize(unsigned char * buffer) const { SERIALIZE(int, 0, item1); SERIALIZE(int, sizeof(int), item2); }<p>
/ serialization typedef enum { record_size = sizeof(int)*2 }; };<p>
There are also generic Serialization routines that you can use if you are serializing containers of T. See <a class="el" href="a00068.html">Serialization.h</a> for more info.<p>
At the moment, this may only load/save 2^32 objects at once. However, it uses 64-bit object IDs.<p>
<dl compact><dt><b>Template Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>start_offset</em>&nbsp;</td><td>This is the offset that ID 0 begins at. This is so you can have data before the serialized items. If you use this, you *must* fill this (and flush the file) before serializing any items! </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="a00069.html#l00103">103</a> of file <a class="el" href="a00069.html">SerializedFile.h</a>.</p>
<hr><h2>Member Enumeration Documentation</h2>
<a class="anchor" name="99054aed7a18dee9afd6ba6e8a3e347f"></a><!-- doxytag: member="SerializedFile::SerializedFileError" ref="99054aed7a18dee9afd6ba6e8a3e347f" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , wxFileOffset start_offset = 0&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="a00019.html#99054aed7a18dee9afd6ba6e8a3e347f">SerializedFile::SerializedFileError</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="99054aed7a18dee9afd6ba6e8a3e347fece3cfbcbe16262f50266fa2b597b634"></a><!-- doxytag: member="ERR_BAD_SEEK" ref="99054aed7a18dee9afd6ba6e8a3e347fece3cfbcbe16262f50266fa2b597b634" args="" -->ERR_BAD_SEEK</em>&nbsp;</td><td>
no error </td></tr>
<tr><td valign="top"><em><a class="anchor" name="99054aed7a18dee9afd6ba6e8a3e347f128d9a14eed7bd9e3ef32d4888189550"></a><!-- doxytag: member="ERR_BAD_WRITE" ref="99054aed7a18dee9afd6ba6e8a3e347f128d9a14eed7bd9e3ef32d4888189550" args="" -->ERR_BAD_WRITE</em>&nbsp;</td><td>
error while seeking </td></tr>
<tr><td valign="top"><em><a class="anchor" name="99054aed7a18dee9afd6ba6e8a3e347f691a032468e8f0a09da4e989921deb58"></a><!-- doxytag: member="ERR_BAD_READ" ref="99054aed7a18dee9afd6ba6e8a3e347f691a032468e8f0a09da4e989921deb58" args="" -->ERR_BAD_READ</em>&nbsp;</td><td>
error while writing 
<p>
error while reading </td></tr>
</table>
</dl>

<p>Definition at line <a class="el" href="a00069.html#l00111">111</a> of file <a class="el" href="a00069.html">SerializedFile.h</a>.</p>

</div>
</div><p>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="7a12f5b8c1959ec98516461816416d3d"></a><!-- doxytag: member="SerializedFile::SerializedFile" ref="7a12f5b8c1959ec98516461816416d3d" args="(const wxFileName &amp;filename, size_t buffer_size=4096)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , wxFileOffset start_offset = 0&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00019.html">SerializedFile</a>&lt; T, start_offset &gt;::<a class="el" href="a00019.html">SerializedFile</a>           </td>
          <td>(</td>
          <td class="paramtype">const wxFileName &amp;&nbsp;</td>
          <td class="paramname"> <em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>buffer_size</em> = <code>4096</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Opens the file. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>filename</em>&nbsp;</td><td>Filename to open </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>buffer_size</em>&nbsp;</td><td>Size (in records) of the buffer (defaults to 4096) </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="a00069.html#l00126">126</a> of file <a class="el" href="a00069.html">SerializedFile.h</a>.</p>

</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="da9cb5dbe8308b74c31a4798c49d255f"></a><!-- doxytag: member="SerializedFile::GetLastId" ref="da9cb5dbe8308b74c31a4798c49d255f" args="() const " -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , wxFileOffset start_offset = 0&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">IdType <a class="el" href="a00019.html">SerializedFile</a>&lt; T, start_offset &gt;::GetLastId           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Gets the last ID contained in the file. 
<p>
<dl class="warning" compact><dt><b>Warning:</b></dt><dd>Do not call this often, the value isn't cached and the Length() operation can take awhile.. </dd></dl>

<p>Definition at line <a class="el" href="a00069.html#l00201">201</a> of file <a class="el" href="a00069.html">SerializedFile.h</a>.</p>

</div>
</div><p>
<a class="anchor" name="3c6b781c2dfa9d9759786602b6e133fe"></a><!-- doxytag: member="SerializedFile::LoadObjects" ref="3c6b781c2dfa9d9759786602b6e133fe" args="(const IdType &amp;start_id, const size_t count, T *dst)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , wxFileOffset start_offset = 0&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">size_type <a class="el" href="a00019.html">SerializedFile</a>&lt; T, start_offset &gt;::LoadObjects           </td>
          <td>(</td>
          <td class="paramtype">const IdType &amp;&nbsp;</td>
          <td class="paramname"> <em>start_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&nbsp;</td>
          <td class="paramname"> <em>count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T *&nbsp;</td>
          <td class="paramname"> <em>dst</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Load objects from the file into an array. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>start_id</em>&nbsp;</td><td>starting id of the object array </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>count</em>&nbsp;</td><td>number of items to load/initialize </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>number of items load </dd></dl>

<p>Definition at line <a class="el" href="a00069.html#l00237">237</a> of file <a class="el" href="a00069.html">SerializedFile.h</a>.</p>

<p>References <a class="el" href="a00069.html#l00115">SerializedFile&lt; T, start_offset &gt;::ERR_BAD_READ</a>, and <a class="el" href="a00069.html#l00113">SerializedFile&lt; T, start_offset &gt;::ERR_BAD_SEEK</a>.</p>

</div>
</div><p>
<a class="anchor" name="dc926bd60ea435b9a1a1adede3a79e7e"></a><!-- doxytag: member="SerializedFile::SaveObjects" ref="dc926bd60ea435b9a1a1adede3a79e7e" args="(const IdType &amp;start_id, const size_t count, const T *const src)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , wxFileOffset start_offset = 0&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">size_t <a class="el" href="a00019.html">SerializedFile</a>&lt; T, start_offset &gt;::SaveObjects           </td>
          <td>(</td>
          <td class="paramtype">const IdType &amp;&nbsp;</td>
          <td class="paramname"> <em>start_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&nbsp;</td>
          <td class="paramname"> <em>count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const T *const &nbsp;</td>
          <td class="paramname"> <em>src</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Writes a specified number of objects from an array to file. 
<p>
<dl class="note" compact><dt><b>Note:</b></dt><dd>Be sure to check that the specified number of objects was saved. Use <a class="el" href="a00019.html#7f72d52abd9202cf7b01933c9b9078aa" title="Returns the most recent error code.">GetErrorCode()</a> if the numbers do not match</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>start_id</em>&nbsp;</td><td>starting id of the object array </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>count</em>&nbsp;</td><td>number of items to save </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>number of items saved </dd></dl>

<p>Definition at line <a class="el" href="a00069.html#l00333">333</a> of file <a class="el" href="a00069.html">SerializedFile.h</a>.</p>

<p>References <a class="el" href="a00069.html#l00113">SerializedFile&lt; T, start_offset &gt;::ERR_BAD_SEEK</a>, and <a class="el" href="a00069.html#l00114">SerializedFile&lt; T, start_offset &gt;::ERR_BAD_WRITE</a>.</p>

</div>
</div><p>
<hr>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="a00069.html">SerializedFile.h</a></ul>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Tue Aug 18 13:28:44 2009 for libsdbx-1.0 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.7 </small></address>
</body>
</html>
